# DigitalForensic-G31 Setup Guide

## Table of Contents
1. [Prerequisites](#prerequisites)
2. [Wazuh Server Installation](#wazuh-server-installation)
3. [Wazuh Agent Installation (Windows)](#wazuh-agent-installation-windows)
4. [Verification](#verification)
5. [Troubleshooting](#troubleshooting)

---

## Prerequisites

**For Wazuh Server (Ubuntu/Linux):**
- Ubuntu 18.04 LTS or later
- Minimum 4GB RAM
- At least 20GB disk space
- Internet connection for package downloads
- sudo privileges

**For Wazuh Agent (Windows):**
- Windows 7 SP1 or later
- PowerShell 5.0 or later
- Administrator privileges
- Network connectivity to Wazuh Manager

**Versions Used:**
- Wazuh: v4.12.0
- Docker: Latest stable

---

## Wazuh Server Installation

### Step 1: Install Docker on Ubuntu

Install Docker's official GPG key and repository:

```bash
# Add Docker's official GPG key
sudo apt-get update
sudo apt-get install ca-certificates curl
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc
sudo chmod a+r /etc/apt/keyrings/docker.asc

# Add the repository to Apt sources
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \
  $(. /etc/os-release && echo "${UBUNTU_CODENAME:-$VERSION_CODENAME}") stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt-get update
```

Install Docker and required plugins:

```bash
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```

**Tip:** You can copy these commands into a `.sh` script to run them automatically.

### Step 2: Verify Docker Installation

```bash
sudo docker run hello-world
```

You should see a "Hello from Docker!" message confirming successful installation.

### Step 3: Clone Wazuh Server Repository

```bash
git clone https://github.com/wazuh/wazuh-docker.git -b v4.12.0
cd wazuh-docker/single-node
```

### Step 4: Generate SSL Certificates

Navigate to the single-node folder and generate the required certificates:

```bash
docker-compose -f generate-indexer-certs.yml run --rm generator
```

This creates the necessary SSL certificates for secure communication between Wazuh components.

### Step 5: Start Wazuh Services

```bash
sudo docker compose up -d
```

The `-d` flag runs containers in detached mode (background).

### Step 6: Access Wazuh Dashboard

Once running, access the Wazuh web interface:
- **URL:** `https://localhost`
- **Default Username:** `admin`
- **Default Password:** Check the compose output or environment file

---

## Wazuh Agent Installation (Windows)

### Prerequisites
- Run PowerShell as Administrator
- Replace `<your-wazuh-manager>` with your Wazuh Manager's IP or hostname

### Step 1: Download Agent Installer

Open PowerShell as Administrator and run:

```powershell
Invoke-WebRequest -Uri "https://packages.wazuh.com/4.x/windows/wazuh-agent-4.12.0-1.msi?raw=1" -OutFile "$env:TEMP\wazuh-agent.msi"
```

### Step 2: Install the MSI Package

```powershell
msiexec.exe /i "$env:TEMP\wazuh-agent.msi" WAZUH_MANAGER="<your-wazuh-manager>" WAZUH_AGENT_NAME="SANDEVISTAN-HOST"
```

Replace `<your-wazuh-manager>` with your actual Wazuh Manager address (e.g., `192.168.1.100` or `wazuh-server.local`).

### Step 3: Start the Agent Service

```powershell
Start-Service -Name OssecSvc
```

---

## Verification

### Verify Wazuh Server

Check Docker containers are running:
```bash
sudo docker ps
```

You should see containers for:
- wazuh.manager
- wazuh.indexer
- wazuh.dashboard

### Verify Wazuh Agent (Windows)

Check agent service status:
```powershell
Get-Service OssecSvc
```

Verify agent installation directory:
```powershell
Get-ChildItem "C:\Program Files (x86)\ossec-agent"
```

Check agent log:
```powershell
Get-Content "C:\Program Files (x86)\ossec-agent\logs\active-response.log"
```

---

## Troubleshooting

### Wazuh Server Issues

**Containers not starting:**
```bash
sudo docker compose logs
```
Check logs for specific error messages.

**Port conflicts:**
If ports 443, 9200, or 5601 are already in use, modify the `docker-compose.yml` file to use different ports.

**Certificate errors:**
Regenerate certificates:
```bash
docker-compose -f generate-indexer-certs.yml run --rm generator
```

### Wazuh Agent Issues

**Agent not connecting:**
- Verify WAZUH_MANAGER IP is correct and reachable
- Check Windows Firewall is not blocking port 1514
- Restart the service: `Restart-Service OssecSvc`

**Agent won't install:**
- Ensure you're running PowerShell as Administrator
- Check system has no conflicting Wazuh installations
- Review MSI log: `msiexec.exe /i wazuh-agent.msi /l*v install.log`

**Service fails to start:**
- Check agent configuration: `C:\Program Files (x86)\ossec-agent\ossec.conf`
- Verify WAZUH_MANAGER address is correct
- Check firewall rules allow outbound connections to port 1514





